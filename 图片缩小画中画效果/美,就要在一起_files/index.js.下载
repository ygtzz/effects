function getQueryString(n){var t=new RegExp("(^|&)"+n+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(t);return null!=e?unescape(e[2]):null}var screenWidth=document.documentElement.clientWidth,screenHeight=document.documentElement.clientHeight,canvasZoom={index:0,isScale:!0,isChange:!0,init:function(){var n=this;try{n.animate()}catch(n){}},createCanvas:function(){var n=this,t=null;try{t=new PIXI.Application(screenWidth,screenHeight,{backgroundColor:"#fff"})}catch(n){}return n.loading(),t},loading:function(){var n=setInterval(function(){"complete"==document.readyState&&($(".content").find(".loadingScale").hide(),$(".content").find(".la-circle").show(),$(".content").find(".loadingStack").css("animation-duration","0.5s"),setTimeout(function(){clearInterval(n),$("#loadingPage").remove()},1e3))},1500)},getData:function(){return[{maxImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/5.jpg",minImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/4.jpg",minWidth:30,minHeight:51,minPosX:109,minPosY:35},{maxImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/4.jpg",minImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/3.jpg",minWidth:48,minHeight:82,minPosX:93,minPosY:316},{maxImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/3.jpg",minImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/2.jpg",minWidth:74,minHeight:121,minPosX:69,minPosY:0},{maxImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/2.jpg",minImgSrc:"https://static.gomefinance.com.cn/tyrk/images/danmu/1.jpg",minWidth:80,minHeight:121,minPosX:505,minPosY:0}]},animate:function(){function n(){g=[];for(var n=0;n<r.length;n++){d=new PIXI.Container;var t=r[n],e=PIXI.Sprite.fromImage(t.maxImgSrc);e.width=screenWidth/(t.minWidth/c),e.height=screenHeight/(t.minHeight/o),e.x=-e.width*t.minPosX/c-screenWidth*t.minPosX/c,e.y=-e.height*t.minPosY/o-screenHeight*t.minPosY/o;var i=PIXI.Sprite.fromImage(t.minImgSrc),a=screenWidth*t.minPosX/c+.015*screenWidth,s=screenHeight*t.minPosY/o;t.minPosY>50&&(s+=.018*screenHeight),a>200&&(a+=34),i.width=screenWidth,i.height=screenHeight,i.x=-a,i.y=-s,d.addChild(e),d.addChild(i),d.position.set(a,s),g.push(d)}}function t(){i.stage.removeChildren(),g.forEach(function(n,t){i.stage.addChild(n)})}var e=this,i=e.createCanvas(),a=i.ticker,s=new PIXI.loaders.Loader,c=640,o=1078;$("#stage").html(i.view);var d=null,r=e.getData();e.index=r.length;var m,h,g=[],u=0,l=0;!function(){$(".btn").on("touchstart",function(){e.isChange&&(u=0,e.isScale?(l=e.index-1,e.index-=1,m=r[l].minWidth/c):(l=e.index,e.index+=1,m=r[l].minWidth/c)),e.isChange=!1,a.started||a.start()}).on("touchmove",function(){a.started||a.start()}).on("touchend",function(){a.stop()}),$(".btn1").on("touchstart",function(){e.isChange&&(u=0,e.isScale?(l=e.index-1,e.index-=1,m=r[l].minWidth/c):(l=e.index,e.index+=1,m=r[l].minWidth/c)),e.isChange=!1,a.started||a.start()}).on("touchmove",function(){a.started||a.start()}).on("touchend",function(){a.stop()})}(),r.forEach(function(n,t){s.add("screen"+t,n.minImgSrc)}),s.load(function(){n(),t(),a.addOnce(function(){a.stop()}),a.add(function(){if(e.isScale){if((h=1-.4*u)<m)return 0===l?(e.isScale=!1,$(".btn").hide(),$(".btn1, .nextPage").show(),a.stop()):l==e.index&&i.stage.setChildIndex(g[l],g.length-1-l),void(e.isChange=!0)}else if(i.stage.children[g.length-1]!==g[l]&&i.stage.setChildIndex(g[l-1],l-1),(h=m+.4*u)>1)return l===g.length-1&&(e.isScale=!0,$(".btn").show(),$(".btn1, .nextPage").hide(),a.stop()),void(e.isChange=!0);u+=.02,g[l].scale.set(h),i.renderer.render(i.stage,!1)})})}};$(function(){$("#screen2").height(screenHeight),$("#screen2, .page").width(screenWidth);var n=null,t=getQueryString("code")?1:0;0!==t&&$("#loadingPage").remove(),$(".wp-inner").fullpage({start:t,afterChange:function(t){$(".edit_panel").hide(),$(".edit_panel input").blur();$(".btn3_con");1===t.cur?(null!=n&&clearTimeout(n),n=setTimeout(function(){$(".barrage .barrage_content").show()},1e3),$(".start").show().addClass("startRight"),$(".disable").text("关闭").addClass("closeRight")):($(".start").removeClass("startRight"),$(".disable").removeClass("closeRight"),$(".barrage .barrage_content").hide(),"block"===$(".edit_panel").css("display")&&($("input[name=text]").val(""),$("div.play_icon").fadeIn(),$(".edit_panel").hide()))}}),canvasZoom.init();var e=$(".music").find("audio")[0];e.onloadedmetadata=function(){var n=function(){e.play(),e.paused||$(".music .m_2").addClass("musicRotate"),document.removeEventListener("touchstart",n,!1),$(".m_2").unbind("click").bind("click",function(){var n=$(this).find("audio")[0];n.paused?(n.play(),$(".m_2").addClass("musicRotate")):(n.pause(),$(".m_2").removeClass("musicRotate"))})};e.play(),e.paused||$(".music .m_2").addClass("musicRotate"),document.addEventListener("WeixinJSBridgeReady",function(){n()},!1),document.addEventListener("touchstart",n,!1)}();var i={title:"美，就要在一起",desc:"穿越千年的爱恋",link:window.location.protocol+"//"+window.location.host+"/danmu/index.html",imgUrl:"https://static.gomefinance.com.cn/tyrk/images/danmu/share.jpg"};wxObj.wx_share(i)});